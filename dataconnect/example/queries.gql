# ===================================================================
# Query Examples for Grade Web App
# Ejemplos de queries para el sistema de gestión de calificaciones
# Enfocado en lectura de Asignaturas, Unidades y Temas
# ===================================================================

# ===================================================================
# USUARIOS (Users)
# ===================================================================

# Obtener usuario por email
query GetUserByEmail($email: String!) @auth(level: USER) {
  users(where: {email: {eq: $email}}) {
    userId
    name
    email
    role
    createdAt
    updatedAt
    updatedBy
    deletedAt
  }
}

# Obtener usuario por userId
query GetUserById($userId: UUID!) @auth(level: USER) {
  users(where: {userId: {eq: $userId}}) {
    userId
    name
    email
    role
    createdAt
    updatedAt
    updatedBy
    deletedAt
  }
}

# ===================================================================
# ASIGNATURAS (Subjects)
# ===================================================================

# Listar todas las asignaturas
query ListSubjects @auth(level: USER) {
  subjects(limit: 10000) {
    subjectId
    name
    code
    levelId
    description
    active
    createdAt
  }
}

# Obtener una asignatura por ID
query GetSubject($subjectId: UUID!) @auth(level: USER) {
  subject(key: { subjectId: $subjectId }) {
    subjectId
    name
    code
    description
    active
    levelId
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# ===================================================================
# UNIDADES (Units)
# ===================================================================

# Listar todas las unidades
query ListUnits @auth(level: USER) {
  units(limit: 10000) {
    unitId
    code
    name
    subjectId
    description
    active
    createdAt
  }
}

# Obtener una unidad por ID
query GetUnit($unitId: UUID!) @auth(level: USER) {
  unit(key: { unitId: $unitId }) {
    unitId
    code
    name
    subjectId
    description
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# ===================================================================
# TEMAS (Topics)
# ===================================================================

# Listar todos los temas
query ListTopics @auth(level: USER) {
  topics(limit: 10000) {
    topicId
    code
    name
    description
    unitId
    active
    createdAt
  }
}

# Obtener un tema por ID
query GetTopic($topicId: UUID!) @auth(level: USER) {
  topic(key: { topicId: $topicId }) {
    topicId
    code
    name
    description
    unitId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# ===================================================================
# CATEGORÍAS DE NIVELES (Level Categories)
# ===================================================================

# Listar todas las categorías de niveles
query ListLevelCategories @auth(level: USER) {
  levelCategories {
    categoryId
    code
    name
    description
    active
    createdAt
  }
}

# Obtener una categoría de nivel por ID
query GetLevelCategory($categoryId: UUID!) @auth(level: USER) {
  levelCategory(key: { categoryId: $categoryId }) {
    categoryId
    code
    name
    description
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# ===================================================================
# NIVELES EDUCACIONALES (Educational Levels)
# ===================================================================

# Listar todos los niveles educacionales
query ListEducationalLevels @auth(level: USER) {
  educationalLevels {
    levelId
    categoryId
    code
    name
    description
    active
    createdAt
  }
}

# Obtener un nivel educacional por ID
query GetEducationalLevel($levelId: UUID!) @auth(level: USER) {
  educationalLevel(key: { levelId: $levelId }) {
    levelId
    categoryId
    code
    name
    description
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# Obtener todos los niveles de una categoría específica
query GetLevelsByCategory($categoryId: UUID!) @auth(level: USER) {
  educationalLevels(where: { categoryId: { eq: $categoryId } }) {
    levelId
    code
    name
    description
    active
    createdAt
  }
}

# ===================================================================
# CURSOS (Courses)
# ===================================================================

# Listar todos los cursos del usuario autenticado
query ListCourses(
  $userId: UUID!,
  $firebaseId: String!
) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
  }
}

# Obtener un curso por ID (solo si pertenece al usuario autenticado)
query GetCourse($courseId: UUID!, $userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { courseId: { eq: $courseId }, userId: { eq: $userId } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# Obtener cursos por usuario (solo para el usuario autenticado)
query GetCoursesByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
  }
}

# Obtener cursos por nivel educacional del usuario autenticado
query GetCoursesByLevel($userId: UUID!, $levelId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId }, levelId: { eq: $levelId } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
  }
}

# ===================================================================
# PREGUNTAS (Questions)
# ===================================================================

# Listar todas las dificultades disponibles
query ListDifficulties @auth(level: USER) {
  difficulties {
    difficultyId
    code
    level
    weight
    description
    active
  }
}

# Obtener una dificultad por ID
query GetDifficulty($difficultyId: UUID!) @auth(level: USER) {
  difficulty(key: { difficultyId: $difficultyId }) {
    difficultyId
    code
    level
    weight
    description
    active
  }
}

# Listar todos los tipos de pregunta disponibles
query ListQuestionTypes @auth(level: USER) {
  questionTypes {
    questionTypeId
    code
    name
    description
    minOptions
    maxOptions
    correctOptions
    active
  }
}

# Obtener un tipo de pregunta por ID
query GetQuestionType($questionTypeId: UUID!) @auth(level: USER) {
  questionType(key: { questionTypeId: $questionTypeId }) {
    questionTypeId
    code
    name
    description
    minOptions
    maxOptions
    correctOptions
    active
  }
}

# Obtener un tipo de pregunta por código
query GetQuestionTypeByCode($code: String!) @auth(level: USER) {
  questionTypes(where: { code: { eq: $code } }) {
    questionTypeId
    code
    name
    description
    minOptions
    maxOptions
    correctOptions
    active
  }
}

# ===================================================================
# TAXONOMÍAS (Taxonomies)
# ===================================================================

# Listar todas las taxonomías
query ListTaxonomies @auth(level: USER) {
  taxonomies {
    taxonomyId
    code
    name
    description
    level
    active
    createdAt
  }
}

# Obtener una taxonomía por ID
query GetTaxonomy($taxonomyId: UUID!) @auth(level: USER) {
  taxonomy(key: { taxonomyId: $taxonomyId }) {
    taxonomyId
    code
    name
    description
    level
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# Obtener una taxonomía por código
query GetTaxonomyByCode($code: String!) @auth(level: USER) {
  taxonomies(where: { code: { eq: $code } }) {
    taxonomyId
    code
    name
    description
    level
    active
    createdAt
  }
}

# Listar todas las taxonomías ordenadas por nivel (Bloom)
query ListTaxonomiesByLevel @auth(level: USER) {
  taxonomies(orderBy: [{level: ASC}]) {
    taxonomyId
    code
    name
    description
    level
    active
    createdAt
  }
}

# Listar preguntas públicas
query ListQuestionsByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  questions(where: { userId: { eq: $userId } }) {
    questionId
    text
    active
    version
    originalQuestionId
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    userId
    allowPartialScore
    isPublic
    createdAt
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
}

# ===================================================================
# ESTADÍSTICAS DEL DASHBOARD
# ===================================================================

# Obtener preguntas del usuario para el dashboard
query GetDashboardQuestions($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  questions(where: { userId: { eq: $userId }, deletedAt: { eq: null } }) {
    questionId
    active
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    isPublic
    createdAt
  }
}

# Obtener datos del sistema para el dashboard (sin autenticación de usuario específico)
query GetDashboardSystemData @auth(level: USER) {
  # Taxonomías disponibles
  taxonomies(where: { active: { eq: true } }) {
    taxonomyId
    name
    code
    level
  }
  
  # Dificultades disponibles
  difficulties(where: { active: { eq: true } }) {
    difficultyId
    code
    level
    weight
  }
  
  # Tipos de pregunta disponibles
  questionTypes(where: { active: { eq: true } }) {
    questionTypeId
    name
    code
  }
  
  # Asignaturas
  subjects(where: { active: { eq: true }, deletedAt: { eq: null } }) {
    subjectId
    code
    name
    levelId
    description
  }
  
  # Unidades
  units(where: { active: { eq: true }, deletedAt: { eq: null } }) {
    unitId
    code
    name
    subjectId
    description
  }
  
  # Temas
  topics(where: { active: { eq: true }, deletedAt: { eq: null } }) {
    topicId
    code
    name
    unitId
    description
  }
}

# Obtener una pregunta por ID (solo del usuario autenticado)
query GetQuestion($questionId: UUID!, $userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  questions(where: { questionId: { eq: $questionId }, userId: { eq: $userId } }) {
    questionId
    text
    active
    version
    originalQuestionId
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    userId
    allowPartialScore
    isPublic
    createdAt
    updatedAt
    updatedBy
    deletedAt
    deletedBy
  }
  questionOptions(where: { questionId: { eq: $questionId } }) {
    questionOptionId
    text
    isCorrect
    position
    score
    questionId
  }
}

# Listar preguntas públicas (disponibles para todos)
query ListPublicQuestions @auth(level: USER) {
  questions(where: { isPublic: { eq: true }, active: { eq: true } }) {
    questionId
    text
    active
    version
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    userId
    allowPartialScore
    createdAt
    updatedAt
  }
}

# Listar preguntas públicas filtradas por dificultad
query ListPublicQuestionsByDifficulty($difficultyId: UUID!) @auth(level: USER) {
  questions(where: { isPublic: { eq: true }, active: { eq: true }, difficultyId: { eq: $difficultyId } }) {
    questionId
    text
    active
    version
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    userId
    allowPartialScore
    createdAt
    updatedAt
  }
}

# Listar preguntas públicas filtradas por tipo
query ListPublicQuestionsByType($questionTypeId: UUID!) @auth(level: USER) {
  questions(where: { isPublic: { eq: true }, active: { eq: true }, questionTypeId: { eq: $questionTypeId } }) {
    questionId
    text
    active
    version
    topicId
    difficultyId
    questionTypeId
    taxonomyId
    userId
    allowPartialScore
    createdAt
    updatedAt
  }
}

# Obtener opciones de una pregunta
query GetQuestionOptions($questionId: UUID!) @auth(level: USER) {
  questionOptions(where: { questionId: { eq: $questionId } }) {
    questionOptionId
    text
    isCorrect
    position
    score
    questionId
  }
}

# ===================================================================
# CURSOS - QUERIES EXTENDIDAS (Courses)
# ===================================================================

# Obtener todos los cursos del usuario
query GetAllCoursesByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId }, deletedAt: { eq: null } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener curso por código (filtrado por usuario)
query GetCourseByCode($userId: UUID!, $code: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId }, code: { eq: $code }, deletedAt: { eq: null } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener cursos por institución (filtrado por usuario)
query GetCoursesByInstitution($userId: UUID!, $institutionName: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId }, institutionName: { eq: $institutionName }, deletedAt: { eq: null } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener cursos por nivel educacional (filtrado por usuario)
query GetCoursesByEducationalLevel($userId: UUID!, $levelId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courses(where: { userId: { eq: $userId }, levelId: { eq: $levelId }, deletedAt: { eq: null } }) {
    courseId
    name
    code
    section
    institutionName
    levelId
    userId
    active
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# ===================================================================
# EVALUACIONES (Evaluations)
# ===================================================================

# Obtener evaluación por ID con sus preguntas y opciones
query GetEvaluationById($userId: UUID!, $evaluationId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { userId: { eq: $userId }, evaluationId: { eq: $evaluationId }, deletedAt: { eq: null } }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
  evaluationQuestions(where: { evaluationId: { eq: $evaluationId } }, orderBy: [{ position: ASC }]) {
    evaluationQuestionId
    evaluationId
    questionId
    points
    position
  }
}

# Obtener todas las evaluaciones del usuario
query GetAllEvaluationsByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { userId: { eq: $userId }, deletedAt: { eq: null } }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
}

# Obtener evaluaciones por rango de fechas
query GetEvaluationsByDateRange($userId: UUID!, $startDate: Date!, $endDate: Date!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { 
    userId: { eq: $userId }, 
    scheduledDate: { ge: $startDate, le: $endDate },
    deletedAt: { eq: null } 
  }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
}

# Obtener evaluaciones por estado
query GetEvaluationsByState($userId: UUID!, $state: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { userId: { eq: $userId }, state: { eq: $state }, deletedAt: { eq: null } }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
}

# Obtener evaluaciones por asignatura
query GetEvaluationsBySubject($userId: UUID!, $subjectId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { userId: { eq: $userId }, subjectId: { eq: $subjectId }, deletedAt: { eq: null } }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
}

# Obtener evaluaciones asignadas a un curso específico
query GetEvaluationsByCourse($userId: UUID!, $courseId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courseEvaluations(where: { courseId: { eq: $courseId } }) {
    courseEvaluationId
    courseId
    evaluationId
    createdAt
    createdBy
  }
}

# Obtener detalle completo de evaluación con preguntas y opciones
query GetEvaluationFullDetail($userId: UUID!, $evaluationId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  evaluations(where: { userId: { eq: $userId }, evaluationId: { eq: $evaluationId }, deletedAt: { eq: null } }) {
    evaluationId
    title
    scheduledDate
    durationMinutes
    gradeScale
    state
    pdfPath
    subjectId
    userId
    createdAt
    updatedAt
    updatedBy
  }
  evaluationQuestions(where: { evaluationId: { eq: $evaluationId } }, orderBy: [{ position: ASC }]) {
    evaluationQuestionId
    evaluationId
    questionId
    points
    position
  }
}

# Obtener preguntas de una evaluación con sus opciones
query GetEvaluationQuestions($evaluationId: UUID!) @auth(level: USER) {
  evaluationQuestions(where: { evaluationId: { eq: $evaluationId } }, orderBy: [{ position: ASC }]) {
    evaluationQuestionId
    evaluationId
    questionId
    points
    position
  }
}

# ===================================================================
# ESTUDIANTES (Students)
# ===================================================================

# Obtener todos los estudiantes creados por el usuario
query GetAllStudentsByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  students(where: { createdBy: { eq: $userId }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
    email
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiante por ID
query GetStudentById($userId: UUID!, $studentId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  students(where: { createdBy: { eq: $userId }, studentId: { eq: $studentId }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
    email
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiante por identifier (RUT, ID, etc.)
query GetStudentByIdentifier($userId: UUID!, $identifier: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  students(where: { createdBy: { eq: $userId }, identifier: { eq: $identifier }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
    email
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiantes por nombre (búsqueda exacta)
query GetStudentsByFirstName($userId: UUID!, $firstName: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  students(where: { createdBy: { eq: $userId }, firstName: { eq: $firstName }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
    email
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiantes por apellido (búsqueda exacta)
query GetStudentsByLastName($userId: UUID!, $lastName: String!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  students(where: { createdBy: { eq: $userId }, lastName: { eq: $lastName }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
    email
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiantes inscritos en un curso específico
query GetStudentsByCourse($userId: UUID!, $courseId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courseStudents(where: { courseId: { eq: $courseId }, deletedAt: { eq: null } }) {
    courseStudentId
    courseId
    studentId
    enrolledOn
    createdAt
    createdBy
  }
}

# Obtener inscripciones de estudiantes con detalle
query GetCourseStudentsDetail($courseId: UUID!) @auth(level: USER) {
  courseStudents(where: { courseId: { eq: $courseId }, deletedAt: { eq: null } }) {
    courseStudentId
    courseId
    studentId
    enrolledOn
    createdAt
    createdBy
    updatedAt
    updatedBy
  }
}

# Obtener estudiantes inscritos en un curso con sus datos completos
query GetCourseStudentsWithDetails($courseId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courseStudents(where: { courseId: { eq: $courseId }, deletedAt: { eq: null } }) {
    courseStudentId
    enrolledOn
    student {
      studentId
      firstName
      lastName
      identifier
      email
      createdAt
      createdBy
      updatedAt
      updatedBy
    }
  }
}

# ===================================================================
# EVALUACIONES DE ESTUDIANTES (Student Evaluations)
# ===================================================================

# Obtener evaluación de estudiante por ID con sus preguntas y respuestas
query GetStudentEvaluationById($studentEvaluationId: UUID!) @auth(level: USER) {
  studentCourseEvaluations(where: { studentCourseEvaluationId: { eq: $studentEvaluationId } }) {
    studentCourseEvaluationId
    courseEvaluationId
    courseStudentId
    totalScore
    grade
    takenOn
    attemptNo
    state
  }
  studentEvaluationQuestions(where: { studentEvaluationId: { eq: $studentEvaluationId } }, orderBy: [{ position: ASC }]) {
    studentEvaluationQuestionId
    studentEvaluationId
    evaluationQuestionId
    position
    scoreObtained
    isCorrect
  }
}

# Obtener evaluaciones de un estudiante específico por studentId
query GetStudentEvaluationsByStudentId($studentId: UUID!) @auth(level: USER) {
  courseStudents(where: { studentId: { eq: $studentId }, deletedAt: { eq: null } }) {
    courseStudentId
    courseId
    studentId
    enrolledOn
  }
}

# Obtener evaluaciones de estudiantes por identifier
query GetStudentEvaluationsByIdentifier($identifier: String!) @auth(level: USER) {
  students(where: { identifier: { eq: $identifier }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
  }
}

# Obtener evaluaciones de estudiantes por nombre
query GetStudentEvaluationsByFirstName($firstName: String!) @auth(level: USER) {
  students(where: { firstName: { eq: $firstName }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
  }
}

# Obtener evaluaciones de estudiantes por apellido
query GetStudentEvaluationsByLastName($lastName: String!) @auth(level: USER) {
  students(where: { lastName: { eq: $lastName }, deletedAt: { eq: null } }) {
    studentId
    firstName
    lastName
    identifier
  }
}

# Obtener las preguntas asignadas a un estudiante en una evaluación
query GetStudentEvaluationQuestions($studentEvaluationId: UUID!) @auth(level: USER) {
  studentEvaluationQuestions(where: { studentEvaluationId: { eq: $studentEvaluationId } }, orderBy: [{ position: ASC }]) {
    studentEvaluationQuestionId
    studentEvaluationId
    evaluationQuestionId
    position
    scoreObtained
    isCorrect
  }
}

# Obtener las respuestas (opciones seleccionadas) de una pregunta del estudiante
query GetStudentAnswerOptions($studentEvaluationQuestionId: UUID!) @auth(level: USER) {
  studentAnswerOptions(where: { studentEvaluationQuestionId: { eq: $studentEvaluationQuestionId } }) {
    studentAnswerOptionId
    studentEvaluationQuestionId
    questionOptionId
  }
}

# Obtener todas las evaluaciones de estudiantes de un curso-evaluación específico
query GetStudentEvaluationsByCourseEvaluation($courseEvaluationId: UUID!) @auth(level: USER) {
  studentCourseEvaluations(where: { courseEvaluationId: { eq: $courseEvaluationId } }) {
    studentCourseEvaluationId
    courseEvaluationId
    courseStudentId
    totalScore
    grade
    takenOn
    attemptNo
    state
  }
}

# Obtener todas las evaluaciones de un curso-estudiante específico
query GetStudentEvaluationsByCourseStudent($courseStudentId: UUID!) @auth(level: USER) {
  studentCourseEvaluations(where: { courseStudentId: { eq: $courseStudentId } }) {
    studentCourseEvaluationId
    courseEvaluationId
    courseStudentId
    totalScore
    grade
    takenOn
    attemptNo
    state
  }
}

# Obtener detalle completo de evaluación de estudiante (evaluación + preguntas + respuestas)
query GetStudentEvaluationFullDetail($studentEvaluationId: UUID!) @auth(level: USER) {
  studentCourseEvaluations(where: { studentCourseEvaluationId: { eq: $studentEvaluationId } }) {
    studentCourseEvaluationId
    courseEvaluationId
    courseStudentId
    totalScore
    grade
    takenOn
    attemptNo
    state
  }
  studentEvaluationQuestions(where: { studentEvaluationId: { eq: $studentEvaluationId } }, orderBy: [{ position: ASC }]) {
    studentEvaluationQuestionId
    studentEvaluationId
    evaluationQuestionId
    position
    scoreObtained
    isCorrect
  }
}

# ===================================================================
# COURSE EVALUATIONS (Asignación de Evaluaciones a Cursos)
# ===================================================================

# Obtener todas las asignaciones de evaluaciones a cursos
query GetCourseEvaluationsByUser($userId: UUID!, $firebaseId: String!) @auth(expr: "firebaseId == auth.uid") {
  courseEvaluations(where: { createdBy: { eq: $userId } }) {
    courseEvaluationId
    courseId
    evaluationId
    createdAt
    createdBy
  }
}

# Obtener asignación de evaluación a curso por ID
query GetCourseEvaluationById($courseEvaluationId: UUID!) @auth(level: USER) {
  courseEvaluations(where: { courseEvaluationId: { eq: $courseEvaluationId } }) {
    courseEvaluationId
    courseId
    evaluationId
    createdAt
    createdBy
  }
}

# Obtener todas las evaluaciones asignadas a un curso
query GetEvaluationsForCourse($courseId: UUID!) @auth(level: USER) {
  courseEvaluations(where: { courseId: { eq: $courseId } }) {
    courseEvaluationId
    courseId
    evaluationId
    createdAt
    createdBy
  }
}

# Obtener todos los cursos donde está asignada una evaluación
query GetCoursesForEvaluation($evaluationId: UUID!) @auth(level: USER) {
  courseEvaluations(where: { evaluationId: { eq: $evaluationId } }) {
    courseEvaluationId
    courseId
    evaluationId
    createdAt
    createdBy
  }
}
